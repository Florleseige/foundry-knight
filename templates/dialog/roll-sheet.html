<div class="dialog-content">
    <input type="text" class="label" value="{{label}}" placeholder="{{localize "KNIGHT.JETS.Nom"}}"/>
    {{#if pnj}}
        {{#each aspects as | key aspect|}}
            <div class="aspect">
                <button type="action" data-select="{{aspect}}" class="{{rollSelectType}} {{#if key.lock}}lock{{/if}}">
                    {{getAspect aspect}}
                </button>
            </div>
        {{/each}}
    {{else}}
        {{#each aspects as | key aspect|}}
            <div class="aspect">
                <h2 class="header">
                    {{getAspect aspect}}
                </h2>
                {{#each key.caracteristiques as | keyCar caracteristique|}}
                    <button type="action" data-select="{{caracteristique}}" class="{{rollSelectType}} {{#if keyCar.lock}}lock{{/if}}">
                        {{getCarac caracteristique}}
                    </button>
                {{/each}}
            </div>
        {{/each}}
    {{/if}}

    <div class="details">
        {{#if pnj}}
            <span class="baseJet">
                {{localize "KNIGHT.ASPECTS.Aspect"}} : <u>{{getAspect base}}</u>
            </span>
        {{else}}
            <span class="baseJet">
                {{localize "KNIGHT.JETS.Base"}} : <u>{{getCarac base}}</u>
            </span>

            <span class="autreJet">
                {{localize "KNIGHT.JETS.AutreCarac"}} :
                {{#each autre}} {{#unless @first}} / {{/unless}}<u>{{getCarac this}}</u> {{/each}}
                {{#if style.selected}} / {{getCarac style.selected}} {{/if}}
            </span>
        {{/if}}
    </div>

    <div class="bonus">
        <label>
            <span>{{localize "KNIGHT.AUTRE.Difficulte"}}</span>
            <input type="number" class="difficulte" value="{{#if difficulte}}{{difficulte}}{{else}}0{{/if}}" min="0" />
        </label>
        <label>
            <span>{{localize "KNIGHT.BONUS.Succes"}}</span>
            <input type="number" class="succesBonus" value="{{succesBonus}}" min="0" />
        </label>
        <label>
            <span>{{localize "KNIGHT.JETS.Modificateur"}}</span>
            <input type="number" class="modificateur" value="{{modificateur}}" />
        </label>
        {{#unless pnj}}
        <div class="styleCombat">
            <span class="label">{{localize "KNIGHT.COMBAT.STYLES.Label"}}</span>
            <span class="info {{#if style.deploy}} clicked {{/if}}">?</span>
            <span class="{{#if style.deploy}} showInfo {{else}} hideInfo {{/if}}">{{{style.info}}}</span>
            <select class="selectStyle">
                {{#select style.raw}}
                <option value="standard">{{localize "KNIGHT.COMBAT.STYLES.STANDARD.Label"}}</option>
                <option value="acouvert">{{localize "KNIGHT.COMBAT.STYLES.ACOUVERT.Label"}}</option>
                <option value="agressif">{{localize "KNIGHT.COMBAT.STYLES.AGRESSIF.Label"}}</option>
                <option value="akimbo">{{localize "KNIGHT.COMBAT.STYLES.AKIMBO.Label"}}</option>
                <option value="ambidextre">{{localize "KNIGHT.COMBAT.STYLES.AMBIDEXTRE.Label"}}</option>
                <option value="defensif">{{localize "KNIGHT.COMBAT.STYLES.DEFENSIF.Label"}}</option>
                <option value="pilonnage">{{localize "KNIGHT.COMBAT.STYLES.PILONNAGE.Label"}}</option>
                <option value="precis">{{localize "KNIGHT.COMBAT.STYLES.PRECIS.Label"}}</option>
                <option value="puissant">{{localize "KNIGHT.COMBAT.STYLES.PUISSANT.Label"}}</option>
                <option value="suppression">{{localize "KNIGHT.COMBAT.STYLES.SUPPRESSION.Label"}}</option>
                {{/select}}
            </select>
        </div>

        <div class="buttons" {{#if (hasStyle 'precis' style.raw)}}{{#if (canUseStyle 'precis' typeWpn idActor idWpn)}}style="display:flex;"{{/if}}{{/if}}>
            {{#each style.caracteristiques as | key caracteristique|}}
            <button type="action" data-select="{{key}}" class="{{hasRollStyleSelected @root/style/selected key}}">
                {{getCarac key}}
            </button>
            {{/each}}
        </div>
        <div class="pilonnage" {{#if (hasStyle 'pilonnage' style.raw)}}{{#if (canUseStyle 'pilonnage' typeWpn idActor idWpn)}}style="display:flex;"{{/if}}{{/if}}>
            <label>
                <span>{{localize "KNIGHT.COMBAT.STYLES.PILONNAGE.Tourspasses"}}</span>
                <input type="number" value="{{style.tourspasses}}" min="1" />
            </label>
            <select>
            {{#select style.type}}
                <option value="degats">{{localize "KNIGHT.AUTRE.Degats"}}</option>
                <option value="violence">{{localize "KNIGHT.AUTRE.Violence"}}</option>
            {{/select}}
            </select>
        </div>
        <div class="puissant" {{#if (hasStyle 'puissant' style.raw)}}{{#if (canUseStyle 'puissant' typeWpn idActor idWpn)}}style="display:flex;"{{/if}}{{/if}}>
            <label>
                <span>{{localize "KNIGHT.COMBAT.STYLES.PUISSANT.Sacrifice"}}</span>
                <input type="number" value="{{style.sacrifice}}" min="0" max="6" />
            </label>
            <select>
            {{#select style.type}}
                <option value="degats">{{localize "KNIGHT.AUTRE.Degats"}}</option>
                <option value="violence">{{localize "KNIGHT.AUTRE.Violence"}}</option>
            {{/select}}
            </select>
        </div>
        <div class="puissant" {{#if (hasStyle 'suppression' style.raw)}}{{#if (canUseStyle 'suppression' typeWpn idActor idWpn)}}style="display:flex;"{{/if}}{{/if}}>
            <label>
                <span>{{localize "KNIGHT.COMBAT.STYLES.SUPPRESSION.Sacrifice"}}</span>
                <input type="number" value="{{style.sacrifice}}" min="0" max="{{style.maximum}}" />
            </label>
            <select>
            {{#select style.type}}
                <option value="degats">{{localize "KNIGHT.AUTRE.Degats"}}</option>
                <option value="violence">{{localize "KNIGHT.AUTRE.Violence"}}</option>
            {{/select}}
            </select>
        </div>
        {{/unless}}
        {{#if (hasWpnSelected idWpn nameWpn typeWpn)}}
        <div class="degatsBonus">
            <span class="label">{{localize "KNIGHT.JETS.ModificateurDegats"}}</span>
            <label>
                <input type="number" class="degatsBonusDice" value="{{degatsBonus.dice}}" />
                <span class="dice">{{localize "KNIGHT.JETS.Des-short"}}6+</span>
                <input type="number" class="degatsBonusFixe" value="{{degatsBonus.fixe}}" />
            </label>
        </div>
        <div class="violenceBonus">
            <span class="label">{{localize "KNIGHT.JETS.ModificateurViolence"}}</span>
            <label>
                <input type="number" class="violenceBonusDice" value="{{violenceBonus.dice}}" />
                <span class="dice">{{localize "KNIGHT.JETS.Des-short"}}6+</span>
                <input type="number" class="violenceBonusFixe" value="{{violenceBonus.fixe}}" />
            </label>
        </div>
        {{/if}}
        {{#unless pnj}}
        <div class="noOd">
            <button type="action" data-value="{{noOd}}" class="noOd {{#if noOd}}selected{{/if}}">
                {{localize "KNIGHT.JETS.NoOd"}}
            </button>
        </div>
        {{/unless}}
    </div>

    {{#unless (isEmpty listWpnContact)}}
    <div class="wpn">
        <h2 class="header">
            {{#if deploy.wpnContact}}
                <i class="far fa-minus-square" data-value="true" data-deploy="wpnContact"></i>
            {{else}}
                <i class="far fa-plus-square" data-value="false" data-deploy="wpnContact"></i>
            {{/if}}
            {{localize "KNIGHT.COMBAT.ARMES.CONTACT.Label"}}
        </h2>
        {{#each listWpnContact as | key contact|}}
            <div class="button {{#if (rollSelectWpn key._id key.name key.system.type @root/idWpn @root/nameWpn @root/typeWpn)}}show{{/if}}" {{#unless @root/deploy/wpnContact}}style="display:none;"{{/unless}}>
                <button type="action" data-id="{{key._id}}" data-type="contact" data-name="{{key.name}}" data-num="{{contact}}" class="{{#if (rollSelectWpn key._id key.name key.system.type @root/idWpn @root/nameWpn @root/typeWpn)}}selected{{/if}}">
                    {{key.name}}
                </button>
                <div class="subButtons" {{#unless (rollSelectWpn key._id key.name key.system.type @root/idWpn @root/nameWpn @root/typeWpn)}}style="display:none;"{{/unless}}>

                    <div class="lineParams">
                        {{#if key.system.degats.variable.has}}
                        <label class="params">
                            <span>{{localize "KNIGHT.AUTRE.Degats"}} : </span>
                            <select class="degatsSelected" data-type="contact" data-num="{{contact}}">
                                {{#select key.system.degats.dice}}
                                    {{#each (whileBetweenNumber key.system.degats.variable.min.dice key.system.degats.variable.max.dice) as | kD vD|}}
                                        <option value="{{kD}}">{{kD}}{{localize "KNIGHT.JETS.Des-short"}}6+{{key.system.degats.fixe}}</option>
                                    {{/each}}
                                {{/select}}
                            </select>
                        </label>
                        {{/if}}

                        {{#if key.system.violence.variable.has}}
                        <label class="params">
                            <span>{{localize "KNIGHT.AUTRE.Violence"}} : </span>
                            <select class="violenceSelected" data-type="contact" data-num="{{contact}}">
                                {{#select key.system.violence.dice}}
                                    {{#each (whileBetweenNumber key.system.violence.variable.min.dice key.system.violence.variable.max.dice) as | kV vV|}}
                                        <option value="{{vV}}">{{vV}}{{localize "KNIGHT.JETS.Des-short"}}6+{{key.system.violence.fixe}}</option>
                                    {{/each}}
                                {{/select}}
                            </select>
                        </label>
                        {{/if}}
                    </div>

                    {{#each key.system.degats.module.variable as | keyDgts dgts|}}
                        <div class="lineParams">
                            {{#unless (isLowerThan keyDgts.max.dice 1)}}
                                <label class="paramsTwoLine">
                                    <span>{{localize "KNIGHT.BONUS.DesDegats"}}</span>
                                    <select class="bonusVariable" data-type="contact" data-num="{{contact}}" data-variable="{{dgts}}"
                                        data-typebonus="degats" data-fixeordice="dice" data-energie="{{energie}}">
                                        {{#select keyDgts.selected.dice}}
                                            <option value="0">0{{localize "KNIGHT.JETS.Des-short"}}6</option>
                                            {{#each (whileBetweenNumber keyDgts.min.dice keyDgts.max.dice) as | kD vD|}}
                                                <option value="{{kD}}">{{kD}}{{localize "KNIGHT.JETS.Des-short"}}6</option>
                                            {{/each}}
                                        {{/select}}
                                    </select>
                                </label>
                            {{/unless}}

                            {{#unless (isLowerThan keyDgts.max.fixe 1)}}
                                <label class="paramsTwoLine">
                                    <span>{{localize "KNIGHT.BONUS.FixeDegats"}}</span>
                                    <select class="bonusVariable" data-type="contact" data-num="{{contact}}" data-variable="{{dgts}}"
                                        data-typebonus="degats" data-fixeordice="fixe" data-energie="{{energie}}">
                                        {{#select keyDgts.selected.fixe}}
                                            <option value="0">0</option>
                                            {{#each (whileBetweenNumber keyDgts.min.fixe keyDgts.max.fixe) as | kD vD|}}
                                                <option value="{{kD}}">{{kD}}</option>
                                            {{/each}}
                                        {{/select}}
                                    </select>
                                </label>
                            {{/unless}}
                        </div>
                    {{/each}}

                    {{#each key.system.violence.module.variable as | keyViolence violence|}}
                        <div class="lineParams">
                            {{#unless (isLowerThan keyViolence.max.dice 1)}}
                                <label class="paramsTwoLine">
                                    <span>{{localize "KNIGHT.BONUS.DesViolence"}}</span>
                                    <select class="bonusVariable" data-type="contact" data-num="{{contact}}" data-variable="{{violence}}"
                                        data-typebonus="violence" data-fixeordice="dice" data-energie="{{energie}}">
                                        {{#select keyViolence.selected.dice}}
                                            <option value="0">0{{localize "KNIGHT.JETS.Des-short"}}6</option>
                                            {{#each (whileBetweenNumber keyViolence.min.dice keyViolence.max.dice) as | kV vV|}}
                                                <option value="{{vV}}">{{vV}}{{localize "KNIGHT.JETS.Des-short"}}6</option>
                                            {{/each}}
                                        {{/select}}
                                    </select>
                                </label>
                            {{/unless}}

                            {{#unless (isLowerThan keyViolence.max.fixe 1)}}
                                <label class="paramsTwoLine">
                                    <span>{{localize "KNIGHT.BONUS.FixeViolence"}}</span>
                                    <select class="bonusVariable" data-type="contact" data-num="{{contact}}" data-variable="{{violence}}"
                                        data-typebonus="violence" data-fixeordice="fixe" data-energie="{{energie}}">
                                        {{#select keyViolence.selected.fixe}}
                                            <option value="0">0</option>
                                            {{#each (whileBetweenNumber keyViolence.min.fixe keyViolence.max.fixe) as | kV vV|}}
                                                <option value="{{vV}}">{{vV}}</option>
                                            {{/each}}
                                        {{/select}}
                                    </select>
                                </label>
                            {{/unless}}
                        </div>
                    {{/each}}

                    {{#if key.system.options2mains.has}}
                        <div class="lineParams">
                            <select class="choixmain" data-num="{{contact}}">
                                {{#select key.system.options2mains.actuel}}
                                    <option value="1main">{{localize "KNIGHT.ITEMS.ARME.DEUXMAINS.Unemain"}}</option>
                                    <option value="2main">{{localize "KNIGHT.ITEMS.ARME.DEUXMAINS.Deuxmains"}}</option>
                                {{/select}}
                            </select>
                        </div>
                    {{/if}}

                    {{#if (hasEffet 'tirenrafale' 'effets' key -1)}}
                        <span class="relance relanceDgts" data-id="{{key._id}}" data-type="distance" data-name="{{key.name}}" title="{{localize "KNIGHT.EFFETS.TIRENRAFALE.Relance"}}">{{localize "KNIGHT.EFFETS.TIRENRAFALE.Label"}}</span>
                    {{/if}}

                    {{#if (isWpnDistance @root/typwWpn)}}
                        {{#if (hasEffet 'jumelageambidextrie' 'distance' key -1)}}
                            <div class="blockBtn">
                                <span class="{{#unless @root/jumelageambidextrie}}selected{{else}}unselected{{/unless}}" data-type="jumelageambidextrie" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.AMELIORATIONS.JUMELAGEAMBIDEXTRIE.Desactive"}}</span>
                                <span class="{{#if @root/jumelageambidextrie}}selected{{else}}unselected{{/if}}" data-type="jumelageambidextrie" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.JUMELAGEAMBIDEXTRIE.Active"}}</span>
                            </div>
                        {{else}}
                            {{#if (hasEffet 'jumeleambidextrie' 'effets' key -1)}}
                                <div class="blockBtn">
                                    <span class="{{#unless @root/jumeleambidextrie}}selected{{else}}unselected{{/unless}}" data-type="jumeleambidextrie" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.JUMELEAMBIDEXTRIE.Desactive"}}</span>
                                    <span class="{{#if @root/jumeleambidextrie}}selected{{else}}unselected{{/if}}" data-type="jumeleambidextrie" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.JUMELEAMBIDEXTRIE.Active"}}</span>
                                </div>
                            {{/if}}
                        {{/if}}
                    {{else}}
                        {{#if (hasEffet 'soeur' 'structurelles' key -1)}}
                            <div class="blockBtn">
                                <span class="{{#unless @root/soeur}}selected{{else}}unselected{{/unless}}" data-type="soeur" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.AMELIORATIONS.SOEUR.Desactive"}}</span>
                                <span class="{{#if @root/soeur}}selected{{else}}unselected{{/if}}" data-type="soeur" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.SOEUR.Active"}}</span>
                            </div>
                        {{else}}
                            {{#if (hasEffet 'jumeleambidextrie' 'effets' key -1)}}
                                <div class="blockBtn">
                                    <span class="{{#unless @root/jumeleambidextrie}}selected{{else}}unselected{{/unless}}" data-type="jumeleambidextrie" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.JUMELEAMBIDEXTRIE.Desactive"}}</span>
                                    <span class="{{#if @root/jumeleambidextrie}}selected{{else}}unselected{{/if}}" data-type="jumeleambidextrie" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.JUMELEAMBIDEXTRIE.Active"}}</span>
                                </div>
                            {{/if}}
                        {{/if}}
                    {{/if}}

                    {{#if (hasEffet 'barrage' 'effets' key -1)}}
                        <div class="blockBtn">
                            <span class="{{#unless @root/barrage}}selected{{else}}unselected{{/unless}}" data-type="barrage" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.BARRAGE.Desactive"}}</span>
                            <span class="{{#if @root/barrage}}selected{{else}}unselected{{/if}}" data-type="barrage" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.BARRAGE.Active"}}</span>
                        </div>
                    {{/if}}

                    {{#if (hasEffet 'briserlaresilience' 'effets' key -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/briserlaresilience}}selected{{else}}unselected{{/unless}}" data-type="briserlaresilience" data-value="true" title="{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.CliquerActiver"}}">{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.Desactive"}}</span>
                        <span class="{{#if @root/briserlaresilience}}selected{{else}}unselected{{/if}}" data-type="briserlaresilience" data-value="false" title="{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.CliquerDesactiver"}}">{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'chromeligneslumineuses' 'ornementales' key -1)}}
                        {{#if (hasEffet 'cadence' 'effets' key 2)}}
                            <div class="blockBtn">
                                <span class="{{#unless @root/cadence}}selected{{else}}unselected{{/unless}}" data-type="cadence" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.CADENCE.Desactive"}}</span>
                                <span class="{{#if @root/cadence}}selected{{else}}unselected{{/if}}" data-type="cadence" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.CADENCE.Active"}}</span>
                            </div>
                        {{else}}
                            <div class="blockBtn">
                                <span class="{{#unless @root/chromeligneslumineuses}}selected{{else}}unselected{{/unless}}" data-type="chromeligneslumineuses" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.AMELIORATIONS.CHROMELIGNESLUMINEUSES.Desactive"}}</span>
                                <span class="{{#if @root/chromeligneslumineuses}}selected{{else}}unselected{{/if}}" data-type="chromeligneslumineuses" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.CHROMELIGNESLUMINEUSES.Active"}}</span>
                            </div>
                        {{/if}}
                    {{else}}
                        {{#if (hasEffet 'cadence' 'effets' key -1)}}
                            <div class="blockBtn">
                                <span class="{{#unless @root/cadence}}selected{{else}}unselected{{/unless}}" data-type="cadence" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.CADENCE.Desactive"}}</span>
                                <span class="{{#if @root/cadence}}selected{{else}}unselected{{/if}}" data-type="cadence" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.CADENCE.Active"}}</span>
                            </div>
                        {{/if}}
                    {{/if}}

                    {{#if (hasEffet 'guidage' 'effets' key -1)}}
                        <div class="blockBtn">
                            <span class="{{#unless @root/guidage}}selected{{else}}unselected{{/unless}}" data-type="guidage" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.GUIDAGE.Desactive"}}</span>
                            <span class="{{#if @root/guidage}}selected{{else}}unselected{{/if}}" data-type="guidage" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.GUIDAGE.Active"}}</span>
                        </div>
                    {{/if}}

                    {{#if (hasEffet 'cranerieurgrave' 'ornementales' key -1)}}
                        <div class="blockBtn">
                            <span class="{{#unless @root/cranerieur}}selected{{else}}unselected{{/unless}}" data-type="cranerieur" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.AMELIORATIONS.CRANERIEURGRAVE.Desactive"}}</span>
                            <span class="{{#if @root/cranerieur}}selected{{else}}unselected{{/if}}" data-type="cranerieur" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.CRANERIEURGRAVE.Active"}}</span>
                        </div>
                    {{else}}
                        {{#if (hasEffet 'obliteration' 'effets' key -1)}}
                            <div class="blockBtn">
                                <span class="{{#unless @root/obliteration}}selected{{else}}unselected{{/unless}}" data-type="obliteration" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.OBLITERATION.Desactive"}}</span>
                                <span class="{{#if @root/obliteration}}selected{{else}}unselected{{/if}}" data-type="obliteration" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.OBLITERATION.Active"}}</span>
                            </div>
                        {{/if}}
                    {{/if}}

                    {{#if (hasEffet 'tenebricide' 'effets' key -1)}}
                        <div class="blockBtn">
                            <span class="{{#unless @root/tenebricide}}selected{{else}}unselected{{/unless}}" data-type="tenebricide" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.TENEBRICIDE.Desactive"}}</span>
                            <span class="{{#if @root/tenebricide}}selected{{else}}unselected{{/if}}" data-type="tenebricide" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.TENEBRICIDE.Active"}}</span>
                        </div>
                    {{/if}}
                </div>
            </div>
        {{/each}}
    </div>
    {{/unless}}

    {{#unless (isEmpty listWpnDistance)}}
    <div class="wpn">
        <h2 class="header">
            {{#if deploy.wpnDistance}}
                <i class="far fa-minus-square" data-value="true" data-deploy="wpnDistance"></i>
            {{else}}
                <i class="far fa-plus-square" data-value="false" data-deploy="wpnDistance"></i>
            {{/if}}
            {{localize "KNIGHT.COMBAT.ARMES.DISTANCE.Label"}}
        </h2>
        {{#each listWpnDistance as | key distance|}}
            <div class="button {{#if (rollSelectWpn key._id key.name key.system.type @root/idWpn @root/nameWpn @root/typeWpn)}}show{{/if}}" {{#unless @root/deploy/wpnDistance}}style="display:none;"{{/unless}}>
                <button type="action" data-id="{{key._id}}" data-type="distance" data-name="{{key.name}}" data-num="{{distance}}" class="{{#if (rollSelectWpn key._id key.name key.system.type @root/idWpn @root/nameWpn @root/typeWpn)}}selected{{/if}}">
                    {{key.name}}
                </button>
                <div class="subButtons" {{#unless (rollSelectWpn key._id key.name key.system.type @root/idWpn @root/nameWpn @root/typeWpn)}}style="display:none;"{{/unless}}>
                    <div class="lineParams">
                        {{#if key.system.degats.variable.has}}
                            <label class="params">
                                <span>{{localize "KNIGHT.AUTRE.Degats"}} : </span>
                                <select class="degatsSelected" data-type="distance" data-num="{{distance}}">
                                    {{#select key.system.degats.dice}}
                                        {{#each (whileBetweenNumber key.system.degats.variable.min.dice key.system.degats.variable.max.dice) as | kD vD|}}
                                            <option value="{{kD}}">{{kD}}{{localize "KNIGHT.JETS.Des-short"}}6+{{key.system.degats.fixe}}</option>
                                        {{/each}}
                                    {{/select}}
                                </select>
                            </label>
                        {{/if}}

                        {{#if key.system.violence.variable.has}}
                            <label class="params">
                                <span>{{localize "KNIGHT.AUTRE.Violence"}} : </span>
                                <select class="violenceSelected" data-type="distance" data-num="{{distance}}">
                                    {{#select key.system.violence.dice}}
                                        {{#each (whileBetweenNumber key.system.violence.variable.min.dice key.system.violence.variable.max.dice) as | kV vV|}}
                                            <option value="{{vV}}">{{vV}}{{localize "KNIGHT.JETS.Des-short"}}6+{{key.system.violence.fixe}}</option>
                                        {{/each}}
                                    {{/select}}
                                </select>
                            </label>
                        {{/if}}
                    </div>

                    {{#each key.system.degats.module.variable as | keyDgts dgts|}}
                        <div class="lineParams">
                            {{#unless (isLowerThan keyDgts.max.dice 1)}}
                                <label class="paramsTwoLine">
                                    <span>{{localize "KNIGHT.BONUS.DesDegats"}}</span>
                                    <select class="bonusVariable" data-type="distance" data-num="{{distance}}" data-variable="{{dgts}}"
                                        data-typebonus="degats" data-fixeordice="dice" data-energie="{{energie}}">
                                        {{#select keyDgts.selected.dice}}
                                            <option value="0">0{{localize "KNIGHT.JETS.Des-short"}}6</option>
                                            {{#each (whileBetweenNumber keyDgts.min.dice keyDgts.max.dice) as | kD vD|}}
                                                <option value="{{kD}}">{{kD}}{{localize "KNIGHT.JETS.Des-short"}}6</option>
                                            {{/each}}
                                        {{/select}}
                                    </select>
                                </label>
                            {{/unless}}

                            {{#unless (isLowerThan keyDgts.max.fixe 1)}}
                                <label class="paramsTwoLine">
                                    <span>{{localize "KNIGHT.BONUS.FixeDegats"}}</span>
                                    <select class="bonusVariable" data-type="distance" data-num="{{distance}}" data-variable="{{dgts}}"
                                        data-typebonus="degats" data-fixeordice="fixe" data-energie="{{energie}}">
                                        {{#select keyDgts.selected.fixe}}
                                            <option value="0">0</option>
                                            {{#each (whileBetweenNumber keyDgts.min.fixe keyDgts.max.fixe) as | kD vD|}}
                                                <option value="{{kD}}">{{kD}}</option>
                                            {{/each}}
                                        {{/select}}
                                    </select>
                                </label>
                            {{/unless}}
                        </div>
                    {{/each}}

                    {{#each key.system.violence.module.variable as | keyViolence violence|}}
                        <div class="lineParams">
                            {{#unless (isLowerThan keyViolence.max.dice 1)}}
                                <label class="paramsTwoLine">
                                    <span>{{localize "KNIGHT.BONUS.DesViolence"}}</span>
                                    <select class="bonusVariable" data-type="distance" data-num="{{distance}}" data-variable="{{violence}}"
                                        data-typebonus="violence" data-fixeordice="dice" data-energie="{{energie}}">
                                        {{#select keyViolence.selected.dice}}
                                            <option value="0">0{{localize "KNIGHT.JETS.Des-short"}}6</option>
                                            {{#each (whileBetweenNumber keyViolence.min.dice keyViolence.max.dice) as | kV vV|}}
                                                <option value="{{vV}}">{{vV}}{{localize "KNIGHT.JETS.Des-short"}}6</option>
                                            {{/each}}
                                        {{/select}}
                                    </select>
                                </label>
                            {{/unless}}

                            {{#unless (isLowerThan keyViolence.max.fixe 1)}}
                                <label class="paramsTwoLine">
                                    <span>{{localize "KNIGHT.BONUS.FixeViolence"}}</span>
                                    <select class="bonusVariable" data-type="distance" data-num="{{distance}}" data-variable="{{violence}}"
                                        data-typebonus="violence" data-fixeordice="fixe" data-energie="{{energie}}">
                                        {{#select keyViolence.selected.fixe}}
                                            <option value="0">0</option>
                                            {{#each (whileBetweenNumber keyViolence.min.fixe keyViolence.max.fixe) as | kV vV|}}
                                                <option value="{{vV}}">{{vV}}</option>
                                            {{/each}}
                                        {{/select}}
                                    </select>
                                </label>
                            {{/unless}}
                        </div>
                    {{/each}}

                    {{#if key.system.optionsmunitions.has}}
                        <div class="lineParams">
                            <select class="choixmunition" data-num="{{distance}}" data-niveau="{{key.system.niveau}}">
                                {{#select key.system.optionsmunitions.actuel}}
                                    {{#each key.system.optionsmunitions.liste as | key munition|}}
                                        <option value="{{munition}}">{{key.nom}}</option>
                                    {{/each}}
                                {{/select}}
                            </select>
                        </div>
                    {{/if}}

                    {{#if (hasEffet 'tirenrafale' 'effets' key -1)}}
                        <span class="relance relanceDgts" data-id="{{key._id}}" data-type="distance" data-name="{{key.name}}" title="{{localize "KNIGHT.EFFETS.TIRENRAFALE.Relance"}}">{{localize "KNIGHT.EFFETS.TIRENRAFALE.Label"}}</span>
                    {{else}}
                        {{#if (hasEffet 'systemerefroidissement' 'distance' key -1)}}
                            <span class="relance relanceDgts" data-id="{{key._id}}" data-type="distance" data-name="{{key.name}}" title="{{localize "KNIGHT.EFFETS.TIRENRAFALE.Relance"}}">{{localize "KNIGHT.AMELIORATIONS.SYSTEMEREFROIDISSEMENT.Tirenrafale"}}</span>
                        {{/if}}
                    {{/if}}

                    {{#if (hasEffet 'chargeurballesgrappes' 'distance' key -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/ameliorations/grappes}}selected{{else}}unselected{{/unless}}" data-type="grappes" data-special="ameliorations" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.AMELIORATIONS.CHARGEURBALLESGRAPPES.Desactive"}}</span>
                        <span class="{{#if @root/ameliorations/grappes}}selected{{else}}unselected{{/if}}" data-type="grappes" data-special="ameliorations" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.CHARGEURBALLESGRAPPES.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'chargeurmunitionsexplosives' 'distance' key -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/ameliorations/explosives}}selected{{else}}unselected{{/unless}}" data-type="explosives" data-special="ameliorations" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.AMELIORATIONS.CHARGEURMUNITIONSEXPLOSIVES.Desactive"}}</span>
                        <span class="{{#if @root/ameliorations/explosives}}selected{{else}}unselected{{/if}}" data-type="explosives" data-special="ameliorations" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.CHARGEURMUNITIONSEXPLOSIVES.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'munitionsdrones' 'distance' key -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/ameliorations/drones}}selected{{else}}unselected{{/unless}}" data-type="drones" data-special="ameliorations" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.AMELIORATIONS.MUNITIONSDRONES.Desactive"}}</span>
                        <span class="{{#if @root/ameliorations/drones}}selected{{else}}unselected{{/if}}" data-type="drones" data-special="ameliorations" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.MUNITIONSDRONES.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'munitionshypervelocite' 'distance' key -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/ameliorations/hypervelocite}}selected{{else}}unselected{{/unless}}" data-type="hypervelocite" data-special="ameliorations" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.AMELIORATIONS.MUNITIONSHYPERVELOCITE.Desactive"}}</span>
                        <span class="{{#if @root/ameliorations/hypervelocite}}selected{{else}}unselected{{/if}}" data-type="hypervelocite" data-special="ameliorations" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.MUNITIONSHYPERVELOCITE.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'munitionsiem' 'distance' key -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/ameliorations/iem}}selected{{else}}unselected{{/unless}}" data-type="iem" data-special="ameliorations" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.AMELIORATIONS.MUNITIONSIEM.Desactive"}}</span>
                        <span class="{{#if @root/ameliorations/iem}}selected{{else}}unselected{{/if}}" data-type="iem" data-special="ameliorations" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.MUNITIONSIEM.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'munitionsnonletales' 'distance' key -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/ameliorations/nonletales}}selected{{else}}unselected{{/unless}}" data-type="nonletales" data-special="ameliorations" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.AMELIORATIONS.MUNITIONSNONLETALES.Desactive"}}</span>
                        <span class="{{#if @root/ameliorations/nonletales}}selected{{else}}unselected{{/if}}" data-type="nonletales" data-special="ameliorations" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.MUNITIONSNONLETALES.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'munitionssubsoniques' 'distance' key -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/ameliorations/subsoniques}}selected{{else}}unselected{{/unless}}" data-type="subsoniques" data-special="ameliorations" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.AMELIORATIONS.MUNITIONSSUBSONIQUES.Desactive"}}</span>
                        <span class="{{#if @root/ameliorations/subsoniques}}selected{{else}}unselected{{/if}}" data-type="subsoniques" data-special="ameliorations" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.MUNITIONSSUBSONIQUES.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'barrage' 'effets' key -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/barrage}}selected{{else}}unselected{{/unless}}" data-type="barrage" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.BARRAGE.Desactive"}}</span>
                        <span class="{{#if @root/barrage}}selected{{else}}unselected{{/if}}" data-type="barrage" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.BARRAGE.Active"}}</span>
                    </div>
                    {{else}}
                        {{#if (hasEffet 'systemerefroidissement' 'distance' key -1)}}
                        <div class="blockBtn">
                            <span class="{{#unless @root/systemerefroidissement}}selected{{else}}unselected{{/unless}}" data-type="systemerefroidissement" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.AMELIORATIONS.SYSTEMEREFROIDISSEMENT.Desactive"}}</span>
                            <span class="{{#if @root/systemerefroidissement}}selected{{else}}unselected{{/if}}" data-type="systemerefroidissement" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.SYSTEMEREFROIDISSEMENT.Active"}}</span>
                        </div>
                        {{/if}}
                    {{/if}}

                    {{#if (hasEffet 'briserlaresilience' 'effets' key -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/briserlaresilience}}selected{{else}}unselected{{/unless}}" data-type="briserlaresilience" data-value="true" title="{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.CliquerActiver"}}">{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.Desactive"}}</span>
                        <span class="{{#if @root/briserlaresilience}}selected{{else}}unselected{{/if}}" data-type="briserlaresilience" data-value="false" title="{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.CliquerDesactiver"}}">{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'chambredouble' 'distance' key -1)}}
                        {{#if (hasEffet 'cadence' 'effets' key 2)}}
                            <div class="blockBtn">
                                <span class="{{#unless @root/cadence}}selected{{else}}unselected{{/unless}}" data-type="cadence" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.CADENCE.Desactive"}}</span>
                                <span class="{{#if @root/cadence}}selected{{else}}unselected{{/if}}" data-type="cadence" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.CADENCE.Active"}}</span>
                            </div>
                        {{else}}
                            <div class="blockBtn">
                                <span class="{{#unless @root/chambredouble}}selected{{else}}unselected{{/unless}}" data-type="chambredouble" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.AMELIORATIONS.CHAMBREDOUBLE.Desactive"}}</span>
                                <span class="{{#if @root/chambredouble}}selected{{else}}unselected{{/if}}" data-type="chambredouble" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.CHAMBREDOUBLE.Active"}}</span>
                            </div>
                        {{/if}}
                    {{else}}
                        {{#if (hasEffet 'cadence' 'effets' key -1)}}
                            <div class="blockBtn">
                                <span class="{{#unless @root/cadence}}selected{{else}}unselected{{/unless}}" data-type="cadence" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.CADENCE.Desactive"}}</span>
                                <span class="{{#if @root/cadence}}selected{{else}}unselected{{/if}}" data-type="cadence" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.CADENCE.Active"}}</span>
                            </div>
                        {{/if}}
                    {{/if}}

                    {{#if (hasEffet 'guidage' 'effets' key -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/guidage}}selected{{else}}unselected{{/unless}}" data-type="guidage" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.GUIDAGE.Desactive"}}</span>
                        <span class="{{#if @root/guidage}}selected{{else}}unselected{{/if}}" data-type="guidage" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.GUIDAGE.Active"}}</span>
                    </div>
                    {{/if}}
                    {{#if (hasEffet 'obliteration' 'effets' key -1)}}
                        <div class="blockBtn">
                            <span class="{{#unless @root/obliteration}}selected{{else}}unselected{{/unless}}" data-type="obliteration" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.OBLITERATION.Desactive"}}</span>
                            <span class="{{#if @root/obliteration}}selected{{else}}unselected{{/if}}" data-type="obliteration" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.OBLITERATION.Active"}}</span>
                        </div>
                    {{/if}}

                    {{#if (hasEffet 'tenebricide' 'effets' key -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/tenebricide}}selected{{else}}unselected{{/unless}}" data-type="tenebricide" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.TENEBRICIDE.Desactive"}}</span>
                        <span class="{{#if @root/tenebricide}}selected{{else}}unselected{{/if}}" data-type="tenebricide" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.TENEBRICIDE.Active"}}</span>
                    </div>
                    {{/if}}
                </div>
            </div>
        {{/each}}
    </div>
    {{/unless}}

    {{#unless (isEmpty listWpnTourelle)}}
    <div class="wpn">
        <h2 class="header">
            {{#if deploy.wpnTourelle}}
                <i class="far fa-minus-square" data-value="true" data-deploy="wpnTourelle"></i>
            {{else}}
                <i class="far fa-plus-square" data-value="false" data-deploy="wpnTourelle"></i>
            {{/if}}
            {{localize "KNIGHT.COMBAT.ARMES.TOURELLE.Label"}}
        </h2>
        {{#each listWpnTourelle as | key distance|}}
            <div class="button {{#if (rollSelectWpn key._id key.name 'tourelle' @root/idWpn @root/nameWpn @root/typeWpn)}}show{{/if}}" {{#unless @root/deploy/wpnTourelle}}style="display:none;"{{/unless}}>
                <button type="action" data-id="{{key._id}}" data-type="tourelle" data-name="{{key.name}}" data-num="{{distance}}" class="{{#if (rollSelectWpn key._id key.name 'tourelle' @root/idWpn @root/nameWpn @root/typeWpn)}}selected{{/if}}">
                    {{key.name}}
                </button>
                <div class="subButtons" {{#unless (rollSelectWpn key._id key.name 'tourelle' @root/idWpn @root/nameWpn @root/typeWpn)}}style="display:none;"{{/unless}}>
                    {{#if key.system.degats.variable.has}}
                        <label class="params">
                            <span>{{localize "KNIGHT.AUTRE.Degats"}} : </span>
                            <select class="degatsSelected" data-type="distance" data-num="{{distance}}">
                                {{#select key.system.degats.dice}}
                                    {{#each (whileBetweenNumber key.system.degats.variable.min.dice key.system.degats.variable.max.dice) as | kD vD|}}
                                        <option value="{{kD}}">{{kD}}{{localize "KNIGHT.JETS.Des-short"}}6+{{key.system.degats.fixe}}</option>
                                    {{/each}}
                                {{/select}}
                            </select>
                        </label>
                    {{/if}}

                    {{#if key.system.violence.variable.has}}
                        <label class="params">
                            <span>{{localize "KNIGHT.AUTRE.Violence"}} : </span>
                            <select class="violenceSelected" data-type="distance" data-num="{{distance}}">
                                {{#select key.system.violence.dice}}
                                    {{#each (whileBetweenNumber key.system.violence.variable.min.dice key.system.violence.variable.max.dice) as | kV vV|}}
                                        <option value="{{vV}}">{{vV}}{{localize "KNIGHT.JETS.Des-short"}}6+{{key.system.violence.fixe}}</option>
                                    {{/each}}
                                {{/select}}
                            </select>
                        </label>
                    {{/if}}

                    {{#each key.system.degats.module.variable as | keyDgts dgts|}}
                        <div class="lineParams">
                            {{#unless (isLowerThan keyDgts.max.dice 1)}}
                                <label class="paramsTwoLine">
                                    <span>{{localize "KNIGHT.BONUS.DesDegats"}}</span>
                                    <select class="bonusVariable" data-type="distance" data-num="{{distance}}" data-variable="{{dgts}}"
                                        data-typebonus="degats" data-fixeordice="dice">
                                        {{#select keyDgts.selected.dice}}
                                            <option value="0">0{{localize "KNIGHT.JETS.Des-short"}}6</option>
                                            {{#each (whileBetweenNumber keyDgts.min.dice keyDgts.max.dice) as | kD vD|}}
                                                <option value="{{kD}}">{{kD}}{{localize "KNIGHT.JETS.Des-short"}}6</option>
                                            {{/each}}
                                        {{/select}}
                                    </select>
                                </label>
                            {{/unless}}

                            {{#unless (isLowerThan keyDgts.max.fixe 1)}}
                                <label class="paramsTwoLine">
                                    <span>{{localize "KNIGHT.BONUS.FixeDegats"}}</span>
                                    <select class="bonusVariable" data-type="distance" data-num="{{distance}}" data-variable="{{dgts}}"
                                        data-typebonus="degats" data-fixeordice="fixe">
                                        {{#select keyDgts.selected.fixe}}
                                            <option value="0">0</option>
                                            {{#each (whileBetweenNumber keyDgts.min.fixe keyDgts.max.fixe) as | kD vD|}}
                                                <option value="{{kD}}">{{kD}}</option>
                                            {{/each}}
                                        {{/select}}
                                    </select>
                                </label>
                            {{/unless}}
                        </div>
                        {{/each}}

                        {{#each key.system.violence.module.variable as | keyViolence violence|}}
                        <div class="lineParams">
                            {{#unless (isLowerThan keyViolence.max.dice 1)}}
                                <label class="paramsTwoLine">
                                    <span>{{localize "KNIGHT.BONUS.DesViolence"}}</span>
                                    <select class="bonusVariable" data-type="distance" data-num="{{distance}}" data-variable="{{violence}}"
                                        data-typebonus="violence" data-fixeordice="dice">
                                        {{#select keyViolence.selected.dice}}
                                            <option value="0">0{{localize "KNIGHT.JETS.Des-short"}}6</option>
                                            {{#each (whileBetweenNumber keyViolence.min.dice keyViolence.max.dice) as | kV vV|}}
                                                <option value="{{vV}}">{{vV}}{{localize "KNIGHT.JETS.Des-short"}}6</option>
                                            {{/each}}
                                        {{/select}}
                                    </select>
                                </label>
                            {{/unless}}

                            {{#unless (isLowerThan keyViolence.max.fixe 1)}}
                                <label class="paramsTwoLine">
                                    <span>{{localize "KNIGHT.BONUS.FixeViolence"}}</span>
                                    <select class="bonusVariable" data-type="distance" data-num="{{distance}}" data-variable="{{violence}}"
                                        data-typebonus="violence" data-fixeordice="fixe">
                                        {{#select keyViolence.selected.fixe}}
                                            <option value="0">0</option>
                                            {{#each (whileBetweenNumber keyViolence.min.fixe keyViolence.max.fixe) as | kV vV|}}
                                                <option value="{{vV}}">{{vV}}</option>
                                            {{/each}}
                                        {{/select}}
                                    </select>
                                </label>
                            {{/unless}}
                        </div>
                    {{/each}}

                    {{#if (hasEffet 'tirenrafale' 'effets' key -1)}}
                        <span class="relance relanceDgts" data-id="{{key._id}}" data-type="distance" data-name="{{key.name}}" title="{{localize "KNIGHT.EFFETS.TIRENRAFALE.Relance"}}">{{localize "KNIGHT.EFFETS.TIRENRAFALE.Label"}}</span>
                    {{else}}
                        {{#if (hasEffet 'systemerefroidissement' 'distance' key -1)}}
                            <span class="relance relanceDgts" data-id="{{key._id}}" data-type="distance" data-name="{{key.name}}" title="{{localize "KNIGHT.EFFETS.TIRENRAFALE.Relance"}}">{{localize "KNIGHT.AMELIORATIONS.SYSTEMEREFROIDISSEMENT.Tirenrafale"}}</span>
                        {{/if}}
                    {{/if}}

                    {{#if (hasEffet 'barrage' 'effets' key -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/barrage}}selected{{else}}unselected{{/unless}}" data-type="barrage" data-value="false">{{localize "KNIGHT.EFFETS.BARRAGE.Desactive"}}</span>
                        <span class="{{#if @root/barrage}}selected{{else}}unselected{{/if}}" data-type="barrage" data-value="true">{{localize "KNIGHT.EFFETS.BARRAGE.Active"}}</span>
                    </div>
                    {{else}}
                        {{#if (hasEffet 'systemerefroidissement' 'distance' key -1)}}
                        <div class="blockBtn">
                            <span class="{{#unless @root/systemerefroidissement}}selected{{else}}unselected{{/unless}}" data-type="systemerefroidissement" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.AMELIORATIONS.SYSTEMEREFROIDISSEMENT.Desactive"}}</span>
                            <span class="{{#if @root/systemerefroidissement}}selected{{else}}unselected{{/if}}" data-type="systemerefroidissement" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.SYSTEMEREFROIDISSEMENT.Active"}}</span>
                        </div>
                        {{/if}}
                    {{/if}}

                    {{#if (hasEffet 'briserlaresilience' 'effets' key -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/briserlaresilience}}selected{{else}}unselected{{/unless}}" data-type="briserlaresilience" data-value="true" title="{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.CliquerActiver"}}">{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.Desactive"}}</span>
                        <span class="{{#if @root/briserlaresilience}}selected{{else}}unselected{{/if}}" data-type="briserlaresilience" data-value="false" title="{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.CliquerDesactiver"}}">{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'chambredouble' 'distance' key -1)}}
                        {{#if (hasEffet 'cadence' 'effets' key 2)}}
                            <div class="blockBtn">
                                <span class="{{#unless @root/cadence}}selected{{else}}unselected{{/unless}}" data-type="cadence" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.CADENCE.Desactive"}}</span>
                                <span class="{{#if @root/cadence}}selected{{else}}unselected{{/if}}" data-type="cadence" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.CADENCE.Active"}}</span>
                            </div>
                        {{else}}
                            <div class="blockBtn">
                                <span class="{{#unless @root/chambredouble}}selected{{else}}unselected{{/unless}}" data-type="chambredouble" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.AMELIORATIONS.CHAMBREDOUBLE.Desactive"}}</span>
                                <span class="{{#if @root/chambredouble}}selected{{else}}unselected{{/if}}" data-type="chambredouble" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.CHAMBREDOUBLE.Active"}}</span>
                            </div>
                        {{/if}}
                    {{else}}
                        {{#if (hasEffet 'cadence' 'effets' key -1)}}
                            <div class="blockBtn">
                                <span class="{{#unless @root/cadence}}selected{{else}}unselected{{/unless}}" data-type="cadence" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.CADENCE.Desactive"}}</span>
                                <span class="{{#if @root/cadence}}selected{{else}}unselected{{/if}}" data-type="cadence" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.CADENCE.Active"}}</span>
                            </div>
                        {{/if}}
                    {{/if}}

                    {{#if (hasEffet 'guidage' 'effets' key -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/guidage}}selected{{else}}unselected{{/unless}}" data-type="guidage" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.GUIDAGE.Desactive"}}</span>
                        <span class="{{#if @root/guidage}}selected{{else}}unselected{{/if}}" data-type="guidage" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.GUIDAGE.Active"}}</span>
                    </div>
                    {{/if}}
                    {{#if (hasEffet 'obliteration' 'effets' key -1)}}
                        <div class="blockBtn">
                            <span class="{{#unless @root/obliteration}}selected{{else}}unselected{{/unless}}" data-type="obliteration" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.OBLITERATION.Desactive"}}</span>
                            <span class="{{#if @root/obliteration}}selected{{else}}unselected{{/if}}" data-type="obliteration" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.OBLITERATION.Active"}}</span>
                        </div>
                    {{/if}}

                    {{#if (hasEffet 'tenebricide' 'effets' key -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/tenebricide}}selected{{else}}unselected{{/unless}}" data-type="tenebricide" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.TENEBRICIDE.Desactive"}}</span>
                        <span class="{{#if @root/tenebricide}}selected{{else}}unselected{{/if}}" data-type="tenebricide" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.TENEBRICIDE.Active"}}</span>
                    </div>
                    {{/if}}
                </div>
            </div>
        {{/each}}
    </div>
    {{/unless}}

    {{#unless (isEmpty listGrenades)}}
    <div class="grenades">
        <h2 class="header">
            {{#if deploy.grenades}}
                <i class="far fa-minus-square" data-value="true" data-deploy="grenades"></i>
            {{else}}
                <i class="far fa-plus-square" data-value="false" data-deploy="grenades"></i>
            {{/if}}
            {{localize "KNIGHT.COMBAT.GRENADES.Label"}}
        </h2>

        {{#each listGrenades as | key grenade|}}
            <div class="button {{#if (rollSelectOther grenade 'grenades' @root/nameWpn @root/typeWpn)}}show{{/if}}" {{#unless @root/deploy/grenades}}style="display:none;"{{/unless}}>
                <button type="action" data-type="grenades" data-name="{{grenade}}" class="{{#if (rollSelectOther grenade 'grenades' @root/nameWpn @root/typeWpn)}}selected{{/if}}">
                    {{getGrenadeName grenade}}
                </button>
                <div class="subButtons" {{#unless (rollSelectOther grenade 'grenades' @root/nameWpn @root/typeWpn)}}style="display:none;"{{/unless}}>
                    {{#if (hasEffet 'tirenrafale' 'effets' key -1)}}
                        <span class="relance relanceDgts" data-type="grenades" data-name="{{grenade}}" title="{{localize "KNIGHT.EFFETS.TIRENRAFALE.Relance"}}">{{localize "KNIGHT.EFFETS.TIRENRAFALE.Label"}}</span>
                    {{/if}}

                    {{#if (hasEffet 'barrage' 'effets' key -1)}}
                        <div class="blockBtn">
                            <span class="{{#unless @root/barrage}}selected{{else}}unselected{{/unless}}" data-type="barrage" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.BARRAGE.Desactive"}}</span>
                            <span class="{{#if @root/barrage}}selected{{else}}unselected{{/if}}" data-type="barrage" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.BARRAGE.Active"}}</span>
                        </div>
                    {{/if}}

                    {{#if (hasEffet 'briserlaresilience' 'effets' key -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/briserlaresilience}}selected{{else}}unselected{{/unless}}" data-type="briserlaresilience" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.Desactive"}}</span>
                        <span class="{{#if @root/briserlaresilience}}selected{{else}}unselected{{/if}}" data-type="briserlaresilience" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'cadence' 'effets' key -1)}}
                        <div class="blockBtn">
                            <span class="{{#unless @root/cadence}}selected{{else}}unselected{{/unless}}" data-type="cadence" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.CADENCE.Desactive"}}</span>
                            <span class="{{#if @root/cadence}}selected{{else}}unselected{{/if}}" data-type="cadence" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.CADENCE.Active"}}</span>
                        </div>
                    {{/if}}

                    {{#if (hasEffet 'guidage' 'effets' key -1)}}
                        <div class="blockBtn">
                            <span class="{{#unless @root/guidage}}selected{{else}}unselected{{/unless}}" data-type="guidage" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.GUIDAGE.Desactive"}}</span>
                            <span class="{{#if @root/guidage}}selected{{else}}unselected{{/if}}" data-type="guidage" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.GUIDAGE.Active"}}</span>
                        </div>
                    {{/if}}
                    {{#if (hasEffet 'obliteration' 'effets' key -1)}}
                        <div class="blockBtn">
                            <span class="{{#unless @root/obliteration}}selected{{else}}unselected{{/unless}}" data-type="obliteration" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.OBLITERATION.Desactive"}}</span>
                            <span class="{{#if @root/obliteration}}selected{{else}}unselected{{/if}}" data-type="obliteration" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.OBLITERATION.Active"}}</span>
                        </div>
                    {{/if}}

                    {{#if (hasEffet 'tenebricide' 'effets' key -1)}}
                        <div class="blockBtn">
                            <span class="{{#unless @root/tenebricide}}selected{{else}}unselected{{/unless}}" data-type="tenebricide" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.TENEBRICIDE.Desactive"}}</span>
                            <span class="{{#if @root/tenebricide}}selected{{else}}unselected{{/if}}" data-type="tenebricide" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.TENEBRICIDE.Active"}}</span>
                        </div>
                    {{/if}}
                </div>
            </div>
        {{/each}}
    </div>
    {{/unless}}

    {{#if longbow.has}}
        <div class="longbow">
            <h2 class="header">
                {{localize "KNIGHT.ITEMS.ARMURE.CAPACITES.LONGBOW.Label"}}
            </h2>
            <div class="button">
                <button type="action" data-id="-1" data-type="longbow" data-name="longbow" class="{{#if (rollSelectOther 'longbow' 'longbow' nameWpn typeWpn)}}selected{{/if}}">
                    {{localize "KNIGHT.ITEMS.ARMURE.CAPACITES.LONGBOW.Label"}}

                    {{#if (rollSelectOther 'longbow' 'longbow' nameWpn typeWpn)}}
                    <span>
                        {{localize "KNIGHT.ITEMS.ARMURE.CAPACITES.LONGBOW.Cout"}} : {{longbow.energie}}{{localize "KNIGHT.AUTRE.PointEnergie-short"}}
                    </span>
                    {{/if}}
                </button>
                <div class="data subButtons" {{#unless (rollSelectOther 'longbow' 'longbow' nameWpn typeWpn)}}style="display:none;"{{/unless}}>
                    {{#if (hasEffet 'tirenrafale' 'effets' longbow -1)}}
                        <span class="relance relanceDgts" data-id="{{key._id}}" data-type="distance" data-name="{{key.name}}" title="{{localize "KNIGHT.EFFETS.TIRENRAFALE.Relance"}}">{{localize "KNIGHT.EFFETS.TIRENRAFALE.Label"}}</span>
                    {{/if}}

                    {{#if (hasEffet 'chargeurballesgrappes' 'distance' longbow -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/ameliorations/grappes}}selected{{else}}unselected{{/unless}}" data-type="grappes" data-special="ameliorations" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.CHARGEURBALLESGRAPPES.Desactive"}}</span>
                        <span class="{{#if @root/ameliorations/grappes}}selected{{else}}unselected{{/if}}" data-type="grappes" data-special="ameliorations" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.AMELIORATIONS.CHARGEURBALLESGRAPPES.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'chargeurmunitionsexplosives' 'distance' longbow -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/ameliorations/explosives}}selected{{else}}unselected{{/unless}}" data-type="explosives" data-special="ameliorations" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.CHARGEURMUNITIONSEXPLOSIVES.Desactive"}}</span>
                        <span class="{{#if @root/ameliorations/explosives}}selected{{else}}unselected{{/if}}" data-type="explosives" data-special="ameliorations" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.CHARGEURMUNITIONSEXPLOSIVES.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'munitionsdrones' 'distance' longbow -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/ameliorations/drones}}selected{{else}}unselected{{/unless}}" data-type="drones" data-special="ameliorations" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.MUNITIONSDRONES.Desactive"}}</span>
                        <span class="{{#if @root/ameliorations/drones}}selected{{else}}unselected{{/if}}" data-type="drones" data-special="ameliorations" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.MUNITIONSDRONES.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'munitionshypervelocite' 'distance' longbow -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/ameliorations/hypervelocite}}selected{{else}}unselected{{/unless}}" data-type="hypervelocite" data-special="ameliorations" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.MUNITIONSHYPERVELOCITE.Desactive"}}</span>
                        <span class="{{#if @root/ameliorations/hypervelocite}}selected{{else}}unselected{{/if}}" data-type="hypervelocite" data-special="ameliorations" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.MUNITIONSHYPERVELOCITE.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'munitionsiem' 'distance' longbow -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/ameliorations/iem}}selected{{else}}unselected{{/unless}}" data-type="iem" data-special="ameliorations" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.AMELIORATIONS.MUNITIONSIEM.Desactive"}}</span>
                        <span class="{{#if @root/ameliorations/iem}}selected{{else}}unselected{{/if}}" data-type="iem" data-special="ameliorations" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.MUNITIONSIEM.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'munitionsnonletales' 'distance' longbow -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/ameliorations/nonletales}}selected{{else}}unselected{{/unless}}" data-type="nonletales" data-special="ameliorations" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.MUNITIONSNONLETALES.Desactive"}}</span>
                        <span class="{{#if @root/ameliorations/nonletales}}selected{{else}}unselected{{/if}}" data-type="nonletales" data-special="ameliorations" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.MUNITIONSNONLETALES.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'munitionssubsoniques' 'distance' longbow -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/ameliorations/subsoniques}}selected{{else}}unselected{{/unless}}" data-type="subsoniques" data-special="ameliorations" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.MUNITIONSSUBSONIQUES.Desactive"}}</span>
                        <span class="{{#if @root/ameliorations/subsoniques}}selected{{else}}unselected{{/if}}" data-type="subsoniques" data-special="ameliorations" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.MUNITIONSSUBSONIQUES.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'barrage' 'effets' longbow -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/barrage}}selected{{else}}unselected{{/unless}}" data-type="barrage" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.BARRAGE.Desactive"}}</span>
                        <span class="{{#if @root/barrage}}selected{{else}}unselected{{/if}}" data-type="barrage" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.BARRAGE.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'briserlaresilience' 'effets' longbow -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/briserlaresilience}}selected{{else}}unselected{{/unless}}" data-type="briserlaresilience" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.Desactive"}}</span>
                        <span class="{{#if @root/briserlaresilience}}selected{{else}}unselected{{/if}}" data-type="briserlaresilience" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'cadence' 'effets' longbow -1)}}
                        <div class="blockBtn">
                            <span class="{{#unless @root/cadence}}selected{{else}}unselected{{/unless}}" data-type="cadence" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.CADENCE.Desactive"}}</span>
                            <span class="{{#if @root/cadence}}selected{{else}}unselected{{/if}}" data-type="cadence" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.CADENCE.Active"}}</span>
                        </div>
                    {{/if}}

                    {{#if (hasEffet 'guidage' 'effets' longbow -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/guidage}}selected{{else}}unselected{{/unless}}" data-type="guidage" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.GUIDAGE.Desactive"}}</span>
                        <span class="{{#if @root/guidage}}selected{{else}}unselected{{/if}}" data-type="guidage" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.GUIDAGE.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'obliteration' 'effets' longbow -1)}}
                        <div class="blockBtn">
                            <span class="{{#unless @root/obliteration}}selected{{else}}unselected{{/unless}}" data-type="obliteration" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.OBLITERATION.Desactive"}}</span>
                            <span class="{{#if @root/obliteration}}selected{{else}}unselected{{/if}}" data-type="obliteration" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.OBLITERATION.Active"}}</span>
                        </div>
                    {{/if}}

                    {{#if (hasEffet 'tenebricide' 'effets' longbow -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/tenebricide}}selected{{else}}unselected{{/unless}}" data-type="tenebricide" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.TENEBRICIDE.Desactive"}}</span>
                        <span class="{{#if @root/tenebricide}}selected{{else}}unselected{{/if}}" data-type="tenebricide" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.TENEBRICIDE.Active"}}</span>
                    </div>
                    {{/if}}
                </div>
                <div class="data" {{#unless (rollSelectOther 'longbow' 'longbow' nameWpn typeWpn)}}style="display:none;"{{/unless}}>
                    <label class="degats">
                        <span>{{localize "KNIGHT.AUTRE.Degats"}}</span>
                        <select data-type="degats" data-cost="{{longbow.degats.energie}}">
                            {{#select longbow.degats.dice}}
                                {{#each (whileBetweenNumber longbow.degats.min longbow.degats.max) as | kD vD|}}
                                    <option value="{{kD}}">{{kD}}{{localize "KNIGHT.JETS.Des-short"}}6</option>
                                {{/each}}
                            {{/select}}
                        </select>
                    </label>
                    <label class="violence">
                        <span>{{localize "KNIGHT.AUTRE.Violence"}}</span>
                        <select data-type="violence" data-cost="{{longbow.violence.energie}}">
                            {{#select longbow.violence.dice}}
                                {{#each (whileBetweenNumber longbow.violence.min longbow.violence.max) as | kV vV|}}
                                    <option value="{{vV}}">{{vV}}{{localize "KNIGHT.JETS.Des-short"}}6</option>
                                {{/each}}
                            {{/select}}
                        </select>
                    </label>
                    <label class="portee">
                        <span>{{localize "KNIGHT.PORTEE.Label"}}</span>
                        <select data-type="portee" data-cost="{{longbow.portee.energie}}">
                            {{#select longbow.portee.value}}
                                {{#each (whileBetweenRange longbow.portee.min longbow.portee.max) as | kR vR|}}
                                    <option value="{{kR}}">{{getPortee kR}}</option>
                                {{/each}}
                            {{/select}}
                        </select>
                    </label>
                </div>
                <div class="data" {{#unless (rollSelectOther 'longbow' 'longbow' nameWpn typeWpn)}}style="display:none;"{{/unless}}>
                    <div class="effets {{#if longbow.effets.liste3.acces}}w33{{else}}w50{{/if}} liste1">
                        <h3>
                            {{localize "KNIGHT.EFFETS.Label"}}

                            <span>
                                {{longbow.effets.liste1.energie}} {{localize "KNIGHT.AUTRE.PointEnergie-short"}}
                            </span>
                        </h3>

                        <div class="liste">
                            {{#each longbow.effets.liste1.liste as | key effet|}}
                                <div class="{{#if (hasEffet key.raw 'effets' @root/longbow -1)}}selected{{/if}}">
                                    <span class="label"
                                        data-raw="{{key.raw}}"
                                        data-cost="{{@root/longbow/effets/liste1/energie}}"
                                        data-selectedOnList="{{@root/longbow/effets/liste1/selected}}"
                                        data-liste="liste1">
                                        {{key.name}}
                                    </span>
                                    <img class="info" src="systems/knight/assets/icons/info.svg" />
                                    <span class="hideInfo">{{{getEffetsDescription key.description}}}</span>
                                </div>
                            {{/each}}
                        </div>
                    </div>
                    <div class="effets {{#if longbow.effets.liste3.acces}}w33{{else}}w50{{/if}} liste2">
                        <h3>
                            {{localize "KNIGHT.EFFETS.Label"}}

                            <span>
                                {{longbow.effets.liste2.energie}} {{localize "KNIGHT.AUTRE.PointEnergie-short"}}
                            </span>
                        </h3>
                        <div class="liste">
                            {{#each longbow.effets.liste2.liste as | key effet|}}
                                <div class="{{#if (hasEffet key.raw 'effets' @root/longbow -1)}}selected{{/if}}">
                                    <span class="label"
                                        data-raw="{{key.raw}}"
                                        data-cost="{{@root/longbow/effets/liste2/energie}}"
                                        data-selectedOnList="{{@root/longbow/effets/liste2/selected}}"
                                        data-liste="liste2">
                                        {{key.name}}
                                    </span>
                                    <img class="info" src="systems/knight/assets/icons/info.svg" />
                                    <span class="hideInfo">{{{getEffetsDescription key.description}}}</span>
                                </div>
                            {{/each}}
                        </div>

                    </div>
                    {{#if longbow.effets.liste3.acces}}
                        <div class="effets w33 liste3">
                            <h3>
                                {{localize "KNIGHT.EFFETS.Label"}}

                                <span>
                                    {{longbow.effets.liste3.energie}} {{localize "KNIGHT.AUTRE.PointEnergie-short"}}
                                </span>
                            </h3>

                            <div class="liste">
                                {{#each longbow.effets.liste3.liste as | key effet|}}
                                    <div class="{{#if (hasEffet key.raw 'effets' @root/longbow -1)}}selected{{/if}}">
                                        <span class="label"
                                            data-raw="{{key.raw}}"
                                            data-cost="{{@root/longbow/effets/liste3/energie}}"
                                            data-selectedOnList="{{@root/longbow/effets/liste3/selected}}"
                                            data-liste="liste3">
                                            {{key.name}}
                                        </span>
                                        <img class="info" src="systems/knight/assets/icons/info.svg" />
                                        <span class="hideInfo">{{{getEffetsDescription key.description}}}</span>
                                    </div>
                                {{/each}}
                            </div>

                        </div>
                    {{/if}}
                </div>
            </div>
        </div>
    {{/if}}

    {{#if ma}}
        <div class="wpn wpnMA">
            <h2 class="header">
                {{#if deploy.wpnMA}}
                    <i class="far fa-minus-square" data-value="true" data-deploy="wpnMA"></i>
                {{else}}
                    <i class="far fa-plus-square" data-value="false" data-deploy="wpnMA"></i>
                {{/if}}
                {{localize "KNIGHT.COMBAT.ARMES.Label"}}
            </h2>
            {{#each listWpnMA as | key distance|}}
                <div class="button {{#if (rollSelectWpn key._id key.name key.type @root/idWpn @root/nameWpn @root/typeWpn)}}show{{/if}}" {{#unless @root/deploy/wpnMA}}style="display:none;"{{/unless}}>
                    <button type="action" data-id="{{key._id}}" data-type="{{key.type}}" data-name="{{key.name}}" data-num="{{distance}}" class="{{#if (rollSelectWpn key._id key.name key.type @root/idWpn @root/nameWpn @root/typeWpn)}}selected{{/if}}">
                        {{key.name}}
                    </button>
                    <div class="subButtons" {{#unless (rollSelectWpn key._id key.name key.type @root/idWpn @root/nameWpn @root/typeWpn)}}style="display:none;"{{/unless}}>
                        {{#if @root/hasWraith}}
                        <div class="blockBtn">
                            <span class="{{#unless @root/moduleWraith}}selected{{else}}unselected{{/unless}}" data-type="moduleWraith" data-value="true" title="{{localize "KNIGHT.MECHAARMURE.MODULES.MODULEWRAITH.CliquerMax"}}">{{localize "KNIGHT.MECHAARMURE.MODULES.MODULEWRAITH.PasMax"}}</span>
                            <span class="{{#if @root/moduleWraith}}selected{{else}}unselected{{/if}}" data-type="moduleWraith" data-value="false" title="{{localize "KNIGHT.MECHAARMURE.MODULES.MODULEWRAITH.CliquerPasMax"}}">{{localize "KNIGHT.MECHAARMURE.MODULES.MODULEWRAITH.Max"}}</span>
                        </div>
                        {{/if}}
                        {{#if key.system.degats.variable.has}}
                            <label class="params">
                                <span>{{localize "KNIGHT.AUTRE.Degats"}} : </span>
                                <select class="degatsSelected" data-type="distance" data-num="{{distance}}">
                                    {{#select key.system.degats.dice}}
                                        {{#each (whileBetweenNumber key.system.degats.variable.min.dice key.system.degats.variable.max.dice) as | kD vD|}}
                                            <option value="{{kD}}">{{kD}}{{localize "KNIGHT.JETS.Des-short"}}6+{{key.system.degats.fixe}}</option>
                                        {{/each}}
                                    {{/select}}
                                </select>
                            </label>
                        {{/if}}

                        {{#if key.system.violence.variable.has}}
                            <label class="params">
                                <span>{{localize "KNIGHT.AUTRE.Violence"}} : </span>
                                <select class="violenceSelected" data-type="distance" data-num="{{distance}}">
                                    {{#select key.system.violence.dice}}
                                        {{#each (whileBetweenNumber key.system.violence.variable.min.dice key.system.violence.variable.max.dice) as | kV vV|}}
                                            <option value="{{vV}}">{{vV}}{{localize "KNIGHT.JETS.Des-short"}}6+{{key.system.violence.fixe}}</option>
                                        {{/each}}
                                    {{/select}}
                                </select>
                            </label>
                        {{/if}}

                        {{#if (hasEffet 'tirenrafale' 'effets' key -1)}}
                            <span class="relance relanceDgts" data-id="{{key._id}}" data-type="{{key.type}}" data-name="{{key.name}}" title="{{localize "KNIGHT.EFFETS.TIRENRAFALE.Relance"}}">{{localize "KNIGHT.EFFETS.TIRENRAFALE.Label"}}</span>
                        {{/if}}

                        {{#if (hasEffet 'briserlaresilience' 'effets' key -1)}}
                        <div class="blockBtn">
                            <span class="{{#unless @root/briserlaresilience}}selected{{else}}unselected{{/unless}}" data-type="briserlaresilience" data-value="true" title="{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.CliquerActiver"}}">{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.Desactive"}}</span>
                            <span class="{{#if @root/briserlaresilience}}selected{{else}}unselected{{/if}}" data-type="briserlaresilience" data-value="false" title="{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.CliquerDesactiver"}}">{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.Active"}}</span>
                        </div>
                        {{/if}}

                        {{#if (hasEffet 'barrage' 'effets' key -1)}}
                        <div class="blockBtn">
                            <span class="{{#unless @root/barrage}}selected{{else}}unselected{{/unless}}" data-type="barrage" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.BARRAGE.Desactive"}}</span>
                            <span class="{{#if @root/barrage}}selected{{else}}unselected{{/if}}" data-type="barrage" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.BARRAGE.Active"}}</span>
                        </div>
                        {{/if}}

                        {{#if (hasEffet 'cadence' 'effets' key -1)}}
                        <div class="blockBtn">
                            <span class="{{#unless @root/cadence}}selected{{else}}unselected{{/unless}}" data-type="cadence" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.CADENCE.Desactive"}}</span>
                            <span class="{{#if @root/cadence}}selected{{else}}unselected{{/if}}" data-type="cadence" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.CADENCE.Active"}}</span>
                        </div>
                        {{/if}}

                        {{#if (hasEffet 'guidage' 'effets' key -1)}}
                        <div class="blockBtn">
                            <span class="{{#unless @root/guidage}}selected{{else}}unselected{{/unless}}" data-type="guidage" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.GUIDAGE.Desactive"}}</span>
                            <span class="{{#if @root/guidage}}selected{{else}}unselected{{/if}}" data-type="guidage" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.GUIDAGE.Active"}}</span>
                        </div>
                        {{/if}}

                        {{#if (hasEffet 'obliteration' 'effets' key -1)}}
                            <div class="blockBtn">
                                <span class="{{#unless @root/obliteration}}selected{{else}}unselected{{/unless}}" data-type="obliteration" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.OBLITERATION.Desactive"}}</span>
                                <span class="{{#if @root/obliteration}}selected{{else}}unselected{{/if}}" data-type="obliteration" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.OBLITERATION.Active"}}</span>
                            </div>
                        {{/if}}

                        {{#if (hasEffet 'tenebricide' 'effets' key -1)}}
                        <div class="blockBtn">
                            <span class="{{#unless @root/tenebricide}}selected{{else}}unselected{{/unless}}" data-type="tenebricide" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.TENEBRICIDE.Desactive"}}</span>
                            <span class="{{#if @root/tenebricide}}selected{{else}}unselected{{/if}}" data-type="tenebricide" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.TENEBRICIDE.Active"}}</span>
                        </div>
                        {{/if}}
                    </div>
                </div>
            {{/each}}
        </div>

        {{#unless (isEmpty listWpnSpecial)}}
        {{#each listWpnSpecial as | key distance|}}
        <div class="special">
            <h2 class="header">
                {{key.name}}
            </h2>
            <div class="button">
                <button type="action" data-id="{{key._id}}" data-type="{{key.type}}" data-name="{{key.name}}" data-num="{{distance}}" class="{{#if (rollSelectWpn key._id key.name key.type @root/idWpn @root/nameWpn @root/typeWpn)}}selected{{/if}}">
                    {{key.name}}

                    {{#if (rollSelectWpn key._id key.name key.type @root/idWpn @root/nameWpn @root/typeWpn)}}
                    <span>
                        {{localize "KNIGHT.ITEMS.ARMURE.CAPACITES.LONGBOW.Cout"}} : {{key.energie}}{{localize "KNIGHT.AUTRE.PointEnergie-short"}}
                    </span>
                    {{/if}}
                </button>
                <div class="data subButtons" {{#unless (rollSelectWpn key._id key.name key.type @root/idWpn @root/nameWpn @root/typeWpn)}}style="display:none;"{{/unless}}>
                    {{#if (hasEffet 'tirenrafale' 'effets' key -1)}}
                        <span class="relance relanceDgts" data-id="{{key._id}}" data-type="special" data-name="{{key.name}}" title="{{localize "KNIGHT.EFFETS.TIRENRAFALE.Relance"}}">{{localize "KNIGHT.EFFETS.TIRENRAFALE.Label"}}</span>
                    {{/if}}

                    {{#if (hasEffet 'barrage' 'effets' key -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/barrage}}selected{{else}}unselected{{/unless}}" data-type="barrage" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.BARRAGE.Desactive"}}</span>
                        <span class="{{#if @root/barrage}}selected{{else}}unselected{{/if}}" data-type="barrage" data-value="false"  title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.BARRAGE.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'briserlaresilience' 'effets' key -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/briserlaresilience}}selected{{else}}unselected{{/unless}}" data-type="briserlaresilience" data-value="true" title="{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.CliquerActiver"}}">{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.Desactive"}}</span>
                        <span class="{{#if @root/briserlaresilience}}selected{{else}}unselected{{/if}}" data-type="briserlaresilience" data-value="false" title="{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.CliquerDesactive"}}">{{localize "KNIGHT.EFFETS.BRISERLARESILIENCE.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'cadence' 'effets' key -1)}}
                        <div class="blockBtn">
                            <span class="{{#unless @root/cadence}}selected{{else}}unselected{{/unless}}" data-type="cadence" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.CADENCE.Desactive"}}</span>
                            <span class="{{#if @root/cadence}}selected{{else}}unselected{{/if}}" data-type="cadence" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.CADENCE.Active"}}</span>
                        </div>
                    {{/if}}

                    {{#if (hasEffet 'guidage' 'effets' key -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/guidage}}selected{{else}}unselected{{/unless}}" data-type="guidage" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.GUIDAGE.Desactive"}}</span>
                        <span class="{{#if @root/guidage}}selected{{else}}unselected{{/if}}" data-type="guidage" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.GUIDAGE.Active"}}</span>
                    </div>
                    {{/if}}

                    {{#if (hasEffet 'obliteration' 'effets' key -1)}}
                        <div class="blockBtn">
                            <span class="{{#unless @root/obliteration}}selected{{else}}unselected{{/unless}}" data-type="obliteration" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.OBLITERATION.Desactive"}}</span>
                            <span class="{{#if @root/obliteration}}selected{{else}}unselected{{/if}}" data-type="obliteration" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.OBLITERATION.Active"}}</span>
                        </div>
                    {{/if}}

                    {{#if (hasEffet 'tenebricide' 'effets' key -1)}}
                    <div class="blockBtn">
                        <span class="{{#unless @root/tenebricide}}selected{{else}}unselected{{/unless}}" data-type="tenebricide" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.TENEBRICIDE.Desactive"}}</span>
                        <span class="{{#if @root/tenebricide}}selected{{else}}unselected{{/if}}" data-type="tenebricide" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.TENEBRICIDE.Active"}}</span>
                    </div>
                    {{/if}}
                </div>
                <div class="data" {{#unless (rollSelectWpn key._id key.name key.type @root/idWpn @root/nameWpn @root/typeWpn)}}style="display:none;"{{/unless}}>
                    <div class="effets w50 liste1">
                        <h3>
                            {{localize "KNIGHT.EFFETS.Label"}}

                            <span>
                                {{key.eff1.value}} {{localize "KNIGHT.AUTRE.PointEnergie-short"}}
                            </span>
                        </h3>

                        <div class="liste">
                            {{#each key.eff1.effets.liste as | keyE1 effet|}}
                                <div class="{{#if (hasEffet keyE1.raw 'effets' key -1)}}selected{{/if}}">
                                    <span class="label"
                                        data-raw="{{keyE1.raw}}"
                                        data-cost="{{key.eff1.value}}"
                                        data-liste="eff1",
                                        data-num="{{distance}}">
                                        {{keyE1.name}}
                                    </span>
                                    <img class="info" src="systems/knight/assets/icons/info.svg" />
                                    <span class="hideInfo">{{{getEffetsDescription keyE1.description}}}</span>
                                </div>
                            {{/each}}
                        </div>
                    </div>
                    <div class="effets w50 liste2">
                        <h3>
                            {{localize "KNIGHT.EFFETS.Label"}}

                            <span>
                                {{key.eff2.value}} {{localize "KNIGHT.AUTRE.PointEnergie-short"}}
                            </span>
                        </h3>
                        <div class="liste">
                            {{#each key.eff2.effets.liste as | keyE2 effet|}}
                                <div class="{{#if (hasEffet keyE2.raw 'effets' key -1)}}selected{{/if}}">
                                    <span class="label"
                                        data-raw="{{keyE2.raw}}"
                                        data-cost="{{key.eff2.value}}"
                                        data-liste="eff2",
                                        data-num="{{distance}}">
                                        {{keyE2.name}}
                                    </span>
                                    <img class="info" src="systems/knight/assets/icons/info.svg" />
                                    <span class="hideInfo">{{{getEffetsDescription keyE2.description}}}</span>
                                </div>
                            {{/each}}
                        </div>

                    </div>
                </div>
            </div>
        </div>
        {{/each}}
        {{/unless}}
    {{/if}}

    {{#unless (isEmpty vehicule)}}<div class="wpn borderNone"></div>{{/unless}}

    {{#unless (isEmpty listWpnImprovisees.contact)}}
    <div class="wpn armesimprovisees">
        <h2 class="header">
            {{#if @root/deploy/wpnArmesImproviseesContact}}
                <i class="far fa-minus-square" data-value="true" data-deploy="wpnArmesImproviseesContact"></i>
            {{else}}
                <i class="far fa-plus-square" data-value="false" data-deploy="wpnArmesImproviseesContact"></i>
            {{/if}}
            {{localize "KNIGHT.COMBAT.ARMESIMPROVISEES.LabelContact"}}
        </h2>
        {{#each listWpnImprovisees.contact as | kAI armesimprovisees|}}
            <div class="block">
                {{#unless @root/ma}}
                <h3 class="header">
                    {{#if @root/pnj}}
                        {{localize "KNIGHT.COMBAT.ARMESIMPROVISEES.Chair"}} : {{#each kAI.chair as | key chair|}}{{#unless @first}} - {{/unless}} {{key}} {{/each}}
                        {{else}}
                        {{localize "KNIGHT.COMBAT.ARMESIMPROVISEES.ODForce"}} : {{kAI.force}}
                    {{/if}}
                </h3>
                {{/unless}}
                {{#each kAI.liste as | key arme|}}
                    <div class="button {{#if (rollSelectWpnImprovisees 'contact' 'armesimprovisees' armesimprovisees arme @root/idWpn @root/typeWpn @root/nameWpn @root/num)}}show{{/if}}" {{#unless @root/deploy/wpnArmesImproviseesContact}}style="display:none;"{{/unless}}>
                        <button type="action" data-id="contact" data-type="armesimprovisees" data-name="{{armesimprovisees}}" data-num="{{arme}}" data-caracteristiques="combat,force" class="{{#if (rollSelectWpnImprovisees 'contact' 'armesimprovisees' armesimprovisees arme @root/idWpn @root/typeWpn @root/nameWpn @root/num)}}selected{{/if}}">
                            {{getAI armesimprovisees arme}}
                        </button>
                        <div class="subButtons" {{#unless (rollSelectWpnImprovisees 'contact' 'armesimprovisees' armesimprovisees arme @root/idWpn @root/typeWpn @root/nameWpn @root/num)}}style="display:none;"{{/unless}}>
                            {{#if key.system.degats.variable.has}}
                                <label class="params">
                                    <span>{{localize "KNIGHT.AUTRE.Degats"}} : </span>
                                    <select class="degatsSelected" data-type="distance" data-num="{{distance}}">
                                        {{#select key.system.degats.dice}}
                                            {{#each (whileBetweenNumber key.system.degats.variable.min.dice key.system.degats.variable.max.dice) as | kD vD|}}
                                                <option value="{{kD}}">{{kD}}{{localize "KNIGHT.JETS.Des-short"}}6+{{key.system.degats.fixe}}</option>
                                            {{/each}}
                                        {{/select}}
                                    </select>
                                </label>
                            {{/if}}

                            {{#if key.system.violence.variable.has}}
                                <label class="params">
                                    <span>{{localize "KNIGHT.AUTRE.Violence"}} : </span>
                                    <select class="violenceSelected" data-type="distance" data-num="{{distance}}">
                                        {{#select key.system.violence.dice}}
                                            {{#each (whileBetweenNumber key.system.violence.variable.min.dice key.system.violence.variable.max.dice) as | kV vV|}}
                                                <option value="{{vV}}">{{vV}}{{localize "KNIGHT.JETS.Des-short"}}6+{{key.system.violence.fixe}}</option>
                                            {{/each}}
                                        {{/select}}
                                    </select>
                                </label>
                            {{/if}}

                            {{#each key.system.degats.module.variable as | keyDgts dgts|}}
                                <div class="lineParams">
                                    {{#unless (isLowerThan keyDgts.max.dice 1)}}
                                        <label class="paramsTwoLine">
                                            <span>{{localize "KNIGHT.BONUS.DesDegats"}}</span>
                                            <select class="bonusVariable" data-type="distance" data-num="{{distance}}" data-variable="{{dgts}}"
                                                data-typebonus="degats" data-fixeordice="dice">
                                                {{#select keyDgts.selected.dice}}
                                                    <option value="0">0{{localize "KNIGHT.JETS.Des-short"}}6</option>
                                                    {{#each (whileBetweenNumber keyDgts.min.dice keyDgts.max.dice) as | kD vD|}}
                                                        <option value="{{kD}}">{{kD}}{{localize "KNIGHT.JETS.Des-short"}}6</option>
                                                    {{/each}}
                                                {{/select}}
                                            </select>
                                        </label>
                                    {{/unless}}

                                    {{#unless (isLowerThan keyDgts.max.fixe 1)}}
                                        <label class="paramsTwoLine">
                                            <span>{{localize "KNIGHT.BONUS.FixeDegats"}}</span>
                                            <select class="bonusVariable" data-type="distance" data-num="{{distance}}" data-variable="{{dgts}}"
                                                data-typebonus="degats" data-fixeordice="fixe">
                                                {{#select keyDgts.selected.fixe}}
                                                    <option value="0">0</option>
                                                    {{#each (whileBetweenNumber keyDgts.min.fixe keyDgts.max.fixe) as | kD vD|}}
                                                        <option value="{{kD}}">{{kD}}</option>
                                                    {{/each}}
                                                {{/select}}
                                            </select>
                                        </label>
                                    {{/unless}}
                                </div>
                                {{/each}}

                                {{#each key.system.violence.module.variable as | keyViolence violence|}}
                                <div class="lineParams">
                                    {{#unless (isLowerThan keyViolence.max.dice 1)}}
                                        <label class="paramsTwoLine">
                                            <span>{{localize "KNIGHT.BONUS.DesViolence"}}</span>
                                            <select class="bonusVariable" data-type="distance" data-num="{{distance}}" data-variable="{{violence}}"
                                                data-typebonus="violence" data-fixeordice="dice">
                                                {{#select keyViolence.selected.dice}}
                                                    <option value="0">0{{localize "KNIGHT.JETS.Des-short"}}6</option>
                                                    {{#each (whileBetweenNumber keyViolence.min.dice keyViolence.max.dice) as | kV vV|}}
                                                        <option value="{{vV}}">{{vV}}{{localize "KNIGHT.JETS.Des-short"}}6</option>
                                                    {{/each}}
                                                {{/select}}
                                            </select>
                                        </label>
                                    {{/unless}}

                                    {{#unless (isLowerThan keyViolence.max.fixe 1)}}
                                        <label class="paramsTwoLine">
                                            <span>{{localize "KNIGHT.BONUS.FixeViolence"}}</span>
                                            <select class="bonusVariable" data-type="distance" data-num="{{distance}}" data-variable="{{violence}}"
                                                data-typebonus="violence" data-fixeordice="fixe">
                                                {{#select keyViolence.selected.fixe}}
                                                    <option value="0">0</option>
                                                    {{#each (whileBetweenNumber keyViolence.min.fixe keyViolence.max.fixe) as | kV vV|}}
                                                        <option value="{{vV}}">{{vV}}</option>
                                                    {{/each}}
                                                {{/select}}
                                            </select>
                                        </label>
                                    {{/unless}}
                                </div>
                            {{/each}}

                            {{#if (hasEffet 'tirenrafale' 'effets' key -1)}}
                                <span class="relance relanceDgts" data-id="{{key._id}}" data-type="distance" data-name="{{key.name}}" title="{{localize "KNIGHT.EFFETS.TIRENRAFALE.Relance"}}">{{localize "KNIGHT.EFFETS.TIRENRAFALE.Label"}}</span>
                            {{else}}
                                {{#if (hasEffet 'systemerefroidissement' 'distance' key -1)}}
                                    <span class="relance relanceDgts" data-id="{{key._id}}" data-type="distance" data-name="{{key.name}}" title="{{localize "KNIGHT.EFFETS.TIRENRAFALE.Relance"}}">{{localize "KNIGHT.AMELIORATIONS.SYSTEMEREFROIDISSEMENT.Tirenrafale"}}</span>
                                {{/if}}
                            {{/if}}

                            {{#if (hasEffet 'barrage' 'effets' key -1)}}
                            <div class="blockBtn">
                                <span class="{{#unless @root/barrage}}selected{{else}}unselected{{/unless}}" data-type="barrage" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.BARRAGE.Desactive"}}</span>
                                <span class="{{#if @root/barrage}}selected{{else}}unselected{{/if}}" data-type="barrage" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.BARRAGE.Active"}}</span>
                            </div>
                            {{else}}
                                {{#if (hasEffet 'systemerefroidissement' 'distance' key -1)}}
                                <div class="blockBtn">
                                    <span class="{{#unless @root/systemerefroidissement}}selected{{else}}unselected{{/unless}}" data-type="systemerefroidissement" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.AMELIORATIONS.SYSTEMEREFROIDISSEMENT.Desactive"}}</span>
                                    <span class="{{#if @root/systemerefroidissement}}selected{{else}}unselected{{/if}}" data-type="systemerefroidissement" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.SYSTEMEREFROIDISSEMENT.Active"}}</span>
                                </div>
                                {{/if}}
                            {{/if}}

                            {{#if (hasEffet 'chambredouble' 'distance' key -1)}}
                                {{#if (hasEffet 'cadence' 'effets' key 2)}}
                                    <div class="blockBtn">
                                        <span class="{{#unless @root/cadence}}selected{{else}}unselected{{/unless}}" data-type="cadence" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.CADENCE.Desactive"}}</span>
                                        <span class="{{#if @root/cadence}}selected{{else}}unselected{{/if}}" data-type="cadence" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.CADENCE.Active"}}</span>
                                    </div>
                                {{else}}
                                    <div class="blockBtn">
                                        <span class="{{#unless @root/chambredouble}}selected{{else}}unselected{{/unless}}" data-type="chambredouble" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.AMELIORATIONS.CHAMBREDOUBLE.Desactive"}}</span>
                                        <span class="{{#if @root/chambredouble}}selected{{else}}unselected{{/if}}" data-type="chambredouble" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.AMELIORATIONS.CHAMBREDOUBLE.Active"}}</span>
                                    </div>
                                {{/if}}
                            {{else}}
                                {{#if (hasEffet 'cadence' 'effets' key -1)}}
                                    <div class="blockBtn">
                                        <span class="{{#unless @root/cadence}}selected{{else}}unselected{{/unless}}" data-type="cadence" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.CADENCE.Desactive"}}</span>
                                        <span class="{{#if @root/cadence}}selected{{else}}unselected{{/if}}" data-type="cadence" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.CADENCE.Active"}}</span>
                                    </div>
                                {{/if}}
                            {{/if}}

                            {{#if (hasEffet 'guidage' 'effets' key -1)}}
                            <div class="blockBtn">
                                <span class="{{#unless @root/guidage}}selected{{else}}unselected{{/unless}}" data-type="guidage" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.GUIDAGE.Desactive"}}</span>
                                <span class="{{#if @root/guidage}}selected{{else}}unselected{{/if}}" data-type="guidage" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.GUIDAGE.Active"}}</span>
                            </div>
                            {{/if}}
                            {{#if (hasEffet 'obliteration' 'effets' key -1)}}
                                <div class="blockBtn">
                                    <span class="{{#unless @root/obliteration}}selected{{else}}unselected{{/unless}}" data-type="obliteration" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.OBLITERATION.Desactive"}}</span>
                                    <span class="{{#if @root/obliteration}}selected{{else}}unselected{{/if}}" data-type="obliteration" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.OBLITERATION.Active"}}</span>
                                </div>
                            {{/if}}

                            {{#if (hasEffet 'tenebricide' 'effets' key -1)}}
                            <div class="blockBtn">
                                <span class="{{#unless @root/tenebricide}}selected{{else}}unselected{{/unless}}" data-type="tenebricide" data-value="true" title="{{localize "KNIGHT.AMELIORATIONS.Activer"}}">{{localize "KNIGHT.EFFETS.TENEBRICIDE.Desactive"}}</span>
                                <span class="{{#if @root/tenebricide}}selected{{else}}unselected{{/if}}" data-type="tenebricide" data-value="false" title="{{localize "KNIGHT.AMELIORATIONS.Desactiver"}}">{{localize "KNIGHT.EFFETS.TENEBRICIDE.Active"}}</span>
                            </div>
                            {{/if}}
                        </div>
                    </div>
                {{/each}}
            </div>
        {{/each}}
    </div>
    {{/unless}}

    {{#unless (isEmpty listWpnImprovisees.distance)}}
    <div class="wpn armesimprovisees">
        <h2 class="header">
            {{#if @root/deploy/wpnArmesImproviseesDistance}}
                <i class="far fa-minus-square" data-value="true" data-deploy="wpnArmesImproviseesDistance"></i>
            {{else}}
                <i class="far fa-plus-square" data-value="false" data-deploy="wpnArmesImproviseesDistance"></i>
            {{/if}}
            {{localize "KNIGHT.COMBAT.ARMESIMPROVISEES.LabelDistance"}}
        </h2>
        {{#each listWpnImprovisees.distance as | kAI armesimprovisees|}}
            <div class="block">
                {{#unless @root/ma}}
                <h3 class="header">
                    {{#if @root/pnj}}
                        {{localize "KNIGHT.COMBAT.ARMESIMPROVISEES.Chair"}} : {{#each kAI.chair as | key chair|}}{{#unless @first}} / {{/unless}} {{key}} {{/each}}
                        {{else}}
                        {{localize "KNIGHT.COMBAT.ARMESIMPROVISEES.ODForce"}} : {{kAI.force}}
                    {{/if}}
                </h3>
                {{/unless}}
                {{#each kAI.liste as | key arme|}}
                    <div class="button {{#if (rollSelectWpnImprovisees 'distance' 'armesimprovisees' armesimprovisees arme @root/idWpn @root/typeWpn @root/nameWpn @root/num)}}show{{/if}}"  {{#unless @root/deploy/wpnArmesImproviseesDistance}}style="display:none;"{{/unless}}>
                        <button type="action" data-id="distance" data-type="armesimprovisees" data-name="{{armesimprovisees}}" data-num="{{arme}}" data-caracteristiques="tir,force" data-aspect="chair" class="{{#if (rollSelectWpnImprovisees 'distance' 'armesimprovisees' armesimprovisees arme @root/idWpn @root/typeWpn @root/nameWpn @root/num)}}selected{{/if}}">
                            {{getAI armesimprovisees arme}}
                        </button>
                        <div class="subButtons" {{#unless (rollSelectWpnImprovisees 'distance' 'armesimprovisees' armesimprovisees arme @root/idWpn @root/typeWpn @root/nameWpn @root/num)}}style="display:none;"{{/unless}}>
                            {{#if (hasEffet 'tirenrafale' 'effets' key -1)}}
                                <span class="relance relanceDgts" data-id="{{key._id}}" data-type="distance" data-name="{{key.name}}" title="{{localize "KNIGHT.EFFETS.TIRENRAFALE.Relance"}}">{{localize "KNIGHT.EFFETS.TIRENRAFALE.Label"}}</span>
                            {{else}}
                                {{#if (hasEffet 'systemerefroidissement' 'distance' key -1)}}
                                    <span class="relance relanceDgts" data-id="{{key._id}}" data-type="distance" data-name="{{key.name}}" title="{{localize "KNIGHT.EFFETS.TIRENRAFALE.Relance"}}">{{localize "KNIGHT.AMELIORATIONS.SYSTEMEREFROIDISSEMENT.Tirenrafale"}}</span>
                                {{/if}}
                            {{/if}}

                            {{#if (hasEffet 'barrage' 'effets' key -1)}}
                            <div class="blockBtn">
                                <span class="{{#unless @root/barrage}}selected{{else}}unselected{{/unless}}" data-type="barrage" data-value="false">{{localize "KNIGHT.EFFETS.BARRAGE.Desactive"}}</span>
                                <span class="{{#if @root/barrage}}selected{{else}}unselected{{/if}}" data-type="barrage" data-value="true">{{localize "KNIGHT.EFFETS.BARRAGE.Active"}}</span>
                            </div>
                            {{else}}
                                {{#if (hasEffet 'systemerefroidissement' 'distance' key -1)}}
                                <div class="blockBtn">
                                    <span class="{{#unless @root/systemerefroidissement}}selected{{else}}unselected{{/unless}}" data-type="systemerefroidissement" data-value="false">{{localize "KNIGHT.AMELIORATIONS.SYSTEMEREFROIDISSEMENT.Desactive"}}</span>
                                    <span class="{{#if @root/systemerefroidissement}}selected{{else}}unselected{{/if}}" data-type="systemerefroidissement" data-value="true">{{localize "KNIGHT.AMELIORATIONS.SYSTEMEREFROIDISSEMENT.Active"}}</span>
                                </div>
                                {{/if}}
                            {{/if}}

                            {{#if (hasEffet 'chambredouble' 'distance' key -1)}}
                                {{#if (hasEffet 'cadence' 'effets' key 2)}}
                                    <div class="blockBtn">
                                        <span class="{{#unless @root/cadence}}selected{{else}}unselected{{/unless}}" data-type="cadence" data-value="false">{{localize "KNIGHT.EFFETS.CADENCE.Desactive"}}</span>
                                        <span class="{{#if @root/cadence}}selected{{else}}unselected{{/if}}" data-type="cadence" data-value="true">{{localize "KNIGHT.EFFETS.CADENCE.Active"}}</span>
                                    </div>
                                {{else}}
                                    <div class="blockBtn">
                                        <span class="{{#unless @root/chambredouble}}selected{{else}}unselected{{/unless}}" data-type="chambredouble" data-value="false">{{localize "KNIGHT.AMELIORATIONS.CHAMBREDOUBLE.Desactive"}}</span>
                                        <span class="{{#if @root/chambredouble}}selected{{else}}unselected{{/if}}" data-type="chambredouble" data-value="true">{{localize "KNIGHT.AMELIORATIONS.CHAMBREDOUBLE.Active"}}</span>
                                    </div>
                                {{/if}}
                            {{else}}
                                {{#if (hasEffet 'cadence' 'effets' key -1)}}
                                    <div class="blockBtn">
                                        <span class="{{#unless @root/cadence}}selected{{else}}unselected{{/unless}}" data-type="cadence" data-value="false">{{localize "KNIGHT.EFFETS.CADENCE.Desactive"}}</span>
                                        <span class="{{#if @root/cadence}}selected{{else}}unselected{{/if}}" data-type="cadence" data-value="true">{{localize "KNIGHT.EFFETS.CADENCE.Active"}}</span>
                                    </div>
                                {{/if}}
                            {{/if}}

                            {{#if (hasEffet 'guidage' 'effets' key -1)}}
                            <div class="blockBtn">
                                <span class="{{#unless @root/guidage}}selected{{else}}unselected{{/unless}}" data-type="guidage" data-value="false">{{localize "KNIGHT.EFFETS.GUIDAGE.Desactive"}}</span>
                                <span class="{{#if @root/guidage}}selected{{else}}unselected{{/if}}" data-type="guidage" data-value="true">{{localize "KNIGHT.EFFETS.GUIDAGE.Active"}}</span>
                            </div>
                            {{/if}}
                            {{#if (hasEffet 'obliteration' 'effets' key -1)}}
                                <div class="blockBtn">
                                    <span class="{{#unless @root/obliteration}}selected{{else}}unselected{{/unless}}" data-type="obliteration" data-value="false">{{localize "KNIGHT.EFFETS.OBLITERATION.Desactive"}}</span>
                                    <span class="{{#if @root/obliteration}}selected{{else}}unselected{{/if}}" data-type="obliteration" data-value="true">{{localize "KNIGHT.EFFETS.OBLITERATION.Active"}}</span>
                                </div>
                            {{/if}}

                            {{#if (hasEffet 'tenebricide' 'effets' key -1)}}
                            <div class="blockBtn">
                                <span class="{{#unless @root/tenebricide}}selected{{else}}unselected{{/unless}}" data-type="tenebricide" data-value="false">{{localize "KNIGHT.EFFETS.TENEBRICIDE.Desactive"}}</span>
                                <span class="{{#if @root/tenebricide}}selected{{else}}unselected{{/if}}" data-type="tenebricide" data-value="true">{{localize "KNIGHT.EFFETS.TENEBRICIDE.Active"}}</span>
                            </div>
                            {{/if}}
                        </div>
                    </div>
                {{/each}}
            </div>
        {{/each}}
    </div>
    {{/unless}}
</div>
<div class="dialog-buttons">
    {{#each buttons as |button id|}}
    <button class="dialog-button {{cssClass}}" data-button="{{id}}">
        {{{button.icon}}}
        {{{button.label}}}
    </button>
    {{/each}}
</div>
